FROM postgres

ARG SOURCE
ARG COMMIT_HASH
ARG COMMIT_ID
ARG BUILD_TIME
LABEL source=${SOURCE}
LABEL commit_hash=${COMMIT_HASH}
LABEL commit_id=${COMMIT_ID}
LABEL build_time=${BUILD_TIME}

RUN apt-get update
RUN apt-get install -y apt-utils python3 python3-pip python3-xlrd python3.11-venv curl git

RUN python3 -m venv /venv
# Activate the virtual environment
ENV PATH="/venv/bin:$PATH"

WORKDIR /home/mosip/

COPY ./ .

RUN pip3 install -r requirements.txt

ENV DB_SERVERIP=
ENV DB_PORT=
ENV SU_USER=
ENV DBUSER_PWD=
ENV MOSIP_DB_NAME=
ENV DML_FLAG=
ENV DB_NAMES=
ENV AUDIT_SOURCE_DB_HOST=
ENV AUDIT_SOURCE_DB_PORT=
ENV AUDIT_SOURCE_DB_UNAME=
ENV AUDIT_SOURCE_DB_PASS=
ENV AUDIT_SOURCE_DB_NAME=
ENV AUDIT_SOURCE_SCHEMA_NAME=
ENV CREDENTIAL_SOURCE_DB_HOST=
ENV CREDENTIAL_SOURCE_DB_PORT=
ENV CREDENTIAL_SOURCE_DB_UNAME=
ENV CREDENTIAL_SOURCE_DB_PASS=
ENV CREDENTIAL_SOURCE_DB_NAME=
ENV CREDENTIAL_SOURCE_SCHEMA_NAME=
ENV ESIGNET_SOURCE_DB_HOST=
ENV ESIGNET_SOURCE_DB_PORT=
ENV ESIGNET_SOURCE_DB_UNAME=
ENV ESIGNET_SOURCE_DB_PASS=
ENV ESIGNET_SOURCE_DB_NAME=
ENV ESIGNET_SOURCE_SCHEMA_NAME=
ENV IDA_SOURCE_DB_HOST=
ENV IDA_SOURCE_DB_PORT=
ENV IDA_SOURCE_DB_UNAME=
ENV IDA_SOURCE_DB_PASS=
ENV IDA_SOURCE_DB_NAME=
ENV IDA_SOURCE_SCHEMA_NAME=
ENV IDREPO_SOURCE_DB_HOST=
ENV IDREPO_SOURCE_DB_PORT=
ENV IDREPO_SOURCE_DB_UNAME=
ENV IDREPO_SOURCE_DB_PASS=
ENV IDREPO_SOURCE_DB_NAME=
ENV IDREPO_SOURCE_SCHEMA_NAME=
ENV KERNEL_SOURCE_DB_HOST=
ENV KERNEL_SOURCE_DB_PORT=
ENV KERNEL_SOURCE_DB_UNAME=
ENV KERNEL_SOURCE_DB_PASS=
ENV KERNEL_SOURCE_DB_NAME=
ENV KERNEL_SOURCE_SCHEMA_NAME=
ENV MASTER_SOURCE_DB_HOST=
ENV MASTER_SOURCE_DB_PORT=
ENV MASTER_SOURCE_DB_UNAME=
ENV MASTER_SOURCE_DB_PASS=
ENV MASTER_SOURCE_DB_NAME=
ENV MASTER_SOURCE_SCHEMA_NAME=
ENV PMS_SOURCE_DB_HOST=
ENV PMS_SOURCE_DB_PORT=
ENV PMS_SOURCE_DB_UNAME=
ENV PMS_SOURCE_DB_PASS=
ENV PMS_SOURCE_DB_NAME=
ENV PMS_SOURCE_SCHEMA_NAME=
ENV REGPRC_SOURCE_DB_HOST=
ENV REGPRC_SOURCE_DB_PORT=
ENV REGPRC_SOURCE_DB_UNAME=
ENV REGPRC_SOURCE_DB_PASS=
ENV REGPRC_SOURCE_DB_NAME=
ENV REGPRC_SOURCE_SCHEMA_NAME=
ENV RESIDENT_SOURCE_DB_HOST=
ENV RESIDENT_SOURCE_DB_PORT=
ENV RESIDENT_SOURCE_DB_UNAME=
ENV RESIDENT_SOURCE_DB_PASS=
ENV RESIDENT_SOURCE_DB_NAME=
ENV RESIDENT_SOURCE_SCHEMA_NAME=
ENV ARCHIVE_DB_HOST=
ENV ARCHIVE_DB_PORT=
ENV ARCHIVE_DB_UNAME=
ENV ARCHIVE_DB_PASS=
ENV ARCHIVE_DB_NAME=
ENV ARCHIVE_SCHEMA_NAME=

ENTRYPOINT ["./entrypoint.sh"]
