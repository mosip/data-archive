FROM postgres

ARG SOURCE
ARG COMMIT_HASH
ARG COMMIT_ID
ARG BUILD_TIME
LABEL source=${SOURCE}
LABEL commit_hash=${COMMIT_HASH}
LABEL commit_id=${COMMIT_ID}
LABEL build_time=${BUILD_TIME}

RUN apt-get update
RUN apt-get install -y apt-utils python3 python3-pip python3-xlrd python3.11-venv curl git

RUN python3 -m venv /venv
# Activate the virtual environment
ENV PATH="/venv/bin:$PATH"

WORKDIR /home/mosip/

COPY ./ .

RUN pip3 install -r requirements.txt

ENV DB_SERVERIP=
ENV DB_PORT=
ENV SU_USER=
ENV DBUSER_PWD=
ENV MOSIP_DB_NAME=
ENV DML_FLAG=0
ENV SOURCE_AUDIT_DB_SERVERIP=
ENV SOURCE_AUDIT_DB_PORT=
ENV SOURCE_AUDIT_DB_UNAME=
ENV SOURCE_AUDIT_DB_PASS=
ENV SOURCE_AUDIT_DB_NAME=
ENV SOURCE_AUDIT_SCHEMA_NAME=
ENV SOURCE_CREDENTIAL_DB_SERVERIP=
ENV SOURCE_CREDENTIAL_DB_PORT=
ENV SOURCE_CREDENTIAL_DB_UNAME=
ENV SOURCE_CREDENTIAL_DB_PASS=
ENV SOURCE_CREDENTIAL_DB_NAME=
ENV SOURCE_CREDENTIAL_SCHEMA_NAME=
ENV SOURCE_ESIGNET_DB_SERVERIP=
ENV SOURCE_ESIGNET_DB_PORT=
ENV SOURCE_ESIGNET_DB_UNAME=
ENV SOURCE_ESIGNET_DB_PASS=
ENV SOURCE_ESIGNET_DB_NAME=
ENV SOURCE_ESIGNET_SCHEMA_NAME=
ENV SOURCE_IDA_DB_SERVERIP=
ENV SOURCE_IDA_DB_PORT=
ENV SOURCE_IDA_DB_UNAME=
ENV SOURCE_IDA_DB_PASS=
ENV SOURCE_IDA_DB_NAME=
ENV SOURCE_IDA_SCHEMA_NAME=
ENV SOURCE_IDREPO_DB_SERVERIP=
ENV SOURCE_IDREPO_DB_PORT=
ENV SOURCE_IDREPO_DB_UNAME=
ENV SOURCE_IDREPO_DB_PASS=
ENV SOURCE_IDREPO_DB_NAME=
ENV SOURCE_IDREPO_SCHEMA_NAME=
ENV SOURCE_KERNEL_DB_SERVERIP=
ENV SOURCE_KERNEL_DB_PORT=
ENV SOURCE_KERNEL_DB_UNAME=
ENV SOURCE_KERNEL_DB_PASS=
ENV SOURCE_KERNEL_DB_NAME=
ENV SOURCE_KERNEL_SCHEMA_NAME=
ENV SOURCE_MASTER_DB_SERVERIP=
ENV SOURCE_MASTER_DB_PORT=
ENV SOURCE_MASTER_DB_UNAME=
ENV SOURCE_MASTER_DB_PASS=
ENV SOURCE_AUDIT_DB_NAME=
ENV SOURCE_AUDIT_SCHEMA_NAME=
ENV SOURCE_PMS_DB_SERVERIP=
ENV SOURCE_PMS_DB_PORT=
ENV SOURCE_PMS_DB_UNAME=
ENV SOURCE_PMS_DB_PASS=
ENV SOURCE_PMD_DB_NAME=
ENV SOURCE_PMS_SCHEMA_NAME=
ENV SOURCE_REGPRC_DB_SERVERIP=
ENV SOURCE_REGPRC_DB_PORT=
ENV SOURCE_REGPRC_DB_UNAME=
ENV SOURCE_REGPRC_DB_PASS=
ENV SOURCE_REGPRC_DB_NAME=
ENV SOURCE_REGPRC_SCHEMA_NAME=
ENV SOURCE_RESIDENT_DB_SERVERIP=
ENV SOURCE_RESIDENT_DB_PORT=
ENV SOURCE_RESIDENT_DB_UNAME=
ENV SOURCE_RESIDENT_DB_PASS=
ENV SOURCE_RESIDENT_DB_NAME=
ENV SOURCE_RESIDENT_SCHEMA_NAME=
ENV ARCHIVE_DB_SERVERIP=
ENV ARCHIVE_DB_PORT=
ENV ARCHIVE_DB_UNAME=
ENV ARCHIVE_DB_PASS=
ENV ARCHIVE_DB_NAME=
ENV ARCHIVE_SCHEMA_NAME=

ENTRYPOINT ["./entrypoint.sh"]
